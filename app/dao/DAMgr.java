/**
 * 
 */
package dao;

import java.util.List;

import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient;
import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapper;
import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBScanExpression;
import com.amazonaws.services.dynamodbv2.model.AttributeValue;
import com.amazonaws.services.dynamodbv2.model.ComparisonOperator;
import com.amazonaws.services.dynamodbv2.model.Condition;

import play.Play;

/**
 * @author tieuluu
 * Data Access Manager
 *
 */
public class DAMgr {
	public static final String AWS_ACCESS_KEY = "aws.access.key";
	public static final String AWS_SECRET_KEY = "aws.secret.key";
	
	private static String accessKey;
	private static String secretKey;
	private static AmazonDynamoDBClient dynamoDBClient;
	private static DynamoDBMapper mapper;
	
	static {
		accessKey = Play.application().configuration().getString(AWS_ACCESS_KEY);
        secretKey = Play.application().configuration().getString(AWS_SECRET_KEY);
        dynamoDBClient = new AmazonDynamoDBClient(new BasicAWSCredentials(accessKey, secretKey));
        mapper = new DynamoDBMapper(dynamoDBClient);
	}
	
	public static List getMalwareCatalog() {
		DynamoDBScanExpression scanExpr = new DynamoDBScanExpression();
		scanExpr.addFilterCondition("MalwareID", new Condition()
				.withComparisonOperator(ComparisonOperator.NE)
				.withAttributeValueList(new AttributeValue().withS("MalwareNotifyTopic")));
		return mapper.scan(Malware.class, scanExpr);
	}
}
